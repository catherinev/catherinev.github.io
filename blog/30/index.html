<!DOCTYPE html>
<html>
  <head>
    <title>Catherine V</title>
    <link data-turbolinks-track="true" href="/assets/application.css" media="all" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Gafata' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto:300italic,300,500' rel='stylesheet' type='text/css'>
  </head>

  <body>
    <h1>Catherine Vongsathorn</h1>
    <script src="/assets/application.js"></script>
<div class = "nav">
  <button id = "menu-icon">menu</button>
  <div><a href="/">Home</a></div>
  <div><a href="/about/">About</a></div>
  <div><a href="/blog/">Blog</a></div>
  <div><a href="/experience/">Experience</a></div>
  <div><a href="/links/">Links</a></div>
</div>

    
    <h2>Saturday, September 13, 2014</h2>
<div class = "post">
  <h3>Using LyX to Display Code: Part 3</h3>
  <h5 style="font-weight:bold">Set up a custom environment in LyX</h5>
  <aside><em>Note: part 2 of this tutorial can be found <a href="/blog/29/">here</a>.</em></aside><br/>
  
  <h4>0. Make sure <codein>minted</codein> is working in LaTeX and familiarize yourself with LyX</h4>
  <p>In other words, start by doing <a href="/blog/29/">part 2</a> of this tutorial.  Then, if you have not already used LyX, you should probably play around with it for a bit.  See what it can do.  Use different environments; generate a PDF of your document; change the font style; insert some math; maybe even insert a table (and see if you can customize it).  </p>

  <h4>1. Find the LyX source code files we are going to modify</h4>
  <p>We are going to add a new environment to the <codein>stdlayouts.inc</codein> file.  On a Mac, this file can be found at the following path: <codein>/Applications/LyX.app/Contents/Resources/layouts</codein>.  From the Finder, you can access this by first opening the Applications folder, then right clicking LyX and selecting "Show Package Contents".  From there, select Contents then Resources then layouts, and you should find the desired file.</p>
  <p>Open <codein>stdlayouts.inc</codein> in any text editor.</p>

  <h4>2. Add the new environment to <codein>stdlayouts.inc</codein></h4>

  <p>Scroll to the bottom of <codein>stdlayouts.inc</codein>.  Add the following text:</p>
    <code><pre>Style PythonCode
  Category              MainText
  LatexType             Environment
  LatexName             pythoncode
  Align                 Left
  AlignPossible         Block, Left, Right, Center
  Font
    Family  Typewriter
    Color   Green
  EndFont
  NextNoIndent    1
  ParbreakIsNewline 1
  FreeSpacing   1
  PassThru    1
  KeepEmpty   1
  NewLine     0
  Preamble
  \usepackage{minted}
  \definecolor{bg}{rgb}{0.95,0.95,0.95}
  \newminted{python}{bgcolor=bg}
  EndPreamble
end</pre></code>

  <h4>3. Incorporate the changes into LyX</h4>

  <p>Open LyX.  In the top menu, click "Tools" and select "Reconfigure".  This may take a few seconds.  Once LyX has reconfigured itself, it will prompt you to restart LyX.  Close LyX and then reopen it.</p>

  <p>To verify the change took place, select the drop-down menu of environments on the left.  At the bottom, there should now be an environment called <codein>PythonCode</code>.</p>

  <p>Select <codein>PythonCode</codein> from the dropdown menu and type some stuff using the new environment.  It should appear in green typewriter font, like so.</p>
  <figure style = "width: 70%; margin: auto">
    <img src="/assets/lyx.png" style="width: 100%">
    <figcaption>A LyX document with our new environment: note "PythonCode" in the top left corner.</figcaption>
  </figure>

  <h4>4. Configure LyX preferences</h4>
  <p>If you try to compile to a PDF from within LyX right now, you will get an angry error message.  Remember how, during <a href="/blog/29/">part 2</a>, we had to compile using the flag <codein>-shell-escape</codein>?  Well, we need to tell LyX to use that flag when it compiles.</p>

  <ol style = "list-style-type:lower-alpha;">
    <li>In the top menu click "LyX" and then select "Preferences".  Open "File Handling" and then "Converters".</li>
    <li>Scroll through the "Converter Definitions" until you find "LaTeX(pdflatex) -> PDF(pdflatex)".  Click it to select.  If you can't find that option in the scrolling menu, then add it by manually selecting to "From format:" and "To format:".</li>
    <li>Change the "converter" to <codein>pdflatex --shell-escape $$i</codein> and the "extra flag" to <codein>latex = pdflatex</codein>.</li>
    <li>Click "Modify" and then "Save".</li>
    <!-- <li>Same for "LaTeX(plain) -> PDF(pdflatex)"</li>
    <li>Same for "LyX -> PDF(pdflatex)"</li> -->
  </ol> 
  <p>You should now be able to compile your LyX document to a PDF like usual, and any code in the PythonCode environment will be styled according to the <codein>minted</codein>environment.</p>

  <h4>5. Use the custom environment!</h4>
  <p>That's it!  You now have a working PythonCode environment in LyX.  See the references below for more information on how to customize LyX.</p>

  <h4>References</h4>
  <ul>
    <li><a href = "https://www.sharelatex.com/learn/Defining_your_own_commands#Defining_simple_environments">Define your own LaTeX commands</a></li> 
    <li><a href="http://mirrors.ibiblio.org/CTAN/macros/latex/contrib/minted/minted.pdf"><codein>minted</codein> documentation</a></li>
    <li><a href="https://www.sharelatex.com/learn/Code_Highlighting_with_minted">How to use <codein>minted</codein></a><br>This link also includes a list of the programming languages supported by <codein>minted</codein></li>  
    <li><a href="http://blog.favrik.com/2011/02/22/preview-all-pygments-styles-for-your-code-highlighting-needs/#stylesheetNavigator">Color schemes available in Pygments</a><br>These can also be applied to <codein>minted</codein>, since <codein>minted</codein> uses Pygments</li>
    <li><a href="http://www.tug.org/mactex/index.html">MacTeX</li>
    <li><a href="http://wiki.lyx.org/LyX/Documentation#toc4">LyX documentation</li>
    <li><a href="http://wiki.lyx.org/LyX/DocumentationDevelopment#Customization">Customizing LyX</a><br>This is an excellent resource if you'd like to understand the LyX code we wrote in part 3 or are interested in further customizing LyX.  In particular, see the section on Paragraph Styles under Types of Layout Files.</li>
    <li><a href="http://tug.org/PSTricks/main.cgi?file=pdf/pdfoutput#lyx">Add <codein>-shell-escape</codein> to LyX</a><br>Some of this is in German, but it's pretty easy to infer meaning</li>
    <!-- <li>http://tex.stackexchange.com/questions/125156/how-can-we-enable-shell-escape-to-tex4hts-htlatex-or-related-program</li> -->
  </ul>


</div>


    <footer>
  <div id = "left">Contact me: <a href="mailto:cvong47@gmail.com">Email</a></div>
  <div id = "right">&copy;2015 Catherine Vongsathorn</div>
</footer>


  </body>
</html>
